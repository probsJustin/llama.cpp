--- CMakeLists.txt	2024-05-19 12:00:00
+++ CMakeLists.txt.new	2024-05-19 12:00:00
@@ -84,6 +84,9 @@
 # 3rd party libs
 option(LLAMA_CURL       "llama: use libcurl to download model from an URL" ON)
 option(LLAMA_LLGUIDANCE "llama-common: include LLGuidance library for structured output in common utils" OFF)
+
+# Observability
+option(LLAMA_OTEL_ENABLE "llama: enable OpenTelemetry instrumentation" OFF)
 
 # Required for relocatable CMake package
 include(${CMAKE_CURRENT_SOURCE_DIR}/cmake/build-info.cmake)
@@ -153,6 +156,14 @@
     add_library(ggml ALIAS ggml::ggml)
 endif()
 
+# OpenTelemetry support
+if (LLAMA_OTEL_ENABLE)
+    message(STATUS "OpenTelemetry support enabled")
+    # Define the preprocessor macro
+    add_compile_definitions(LLAMA_OTEL_ENABLE)
+    # Note: The OpenTelemetry C++ SDK is handled in the Dockerfile
+endif()
+
 if (NOT TARGET ggml AND NOT LLAMA_USE_SYSTEM_GGML)
     add_subdirectory(ggml)
     # ... otherwise assume ggml is added by a parent CMakeLists.txt